{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nlet simpleLightBox;\n\n\nconst loader = document.querySelector('.loader-box');\n\nrefs.formEl.addEventListener('submit', onFormSubmit);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\nrefs.formEl.addEventListener('input', e => {\n    const searchWord = refs.formEl.elements.word.value.trim();\n    if (searchWord) {\n        refs.btnEl.disabled = false;\n        refs.btnEl.classList.remove('disabled');\n    };\n});\n\n\n\nasync function onLoadMoreClick() {\n    refs.galleryEl.insertAdjacentHTML(\"afterend\", '<div class=\"loader-box \"><span class=\"loader\"></span></div>');\n    const loader = document.querySelector('.loader-box');\n    currentPage += 1;\n    const data = await getImage();\n    renderImages(data.hits);\n    loader.remove();\n    simpleLightBox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 }).refresh();\n    checkBtnStatus();\n};\n\n\nasync function onFormSubmit(e) {\n    e.preventDefault();\n    refs.formEl.insertAdjacentHTML(\"afterend\", '<div class=\"loader-box \"><span class=\"loader\"></span></div>');\n    const galleryParentElem = document.querySelector('.gallery');\n    if (galleryParentElem) {\n        galleryParentElem.remove();\n    };\n    const loader = document.querySelector('.loader-box');\n    query = e.target.elements.word.value.trim();\n    currentPage = 1;\n    try {\n        const data = await getImage();\n        totalHits = data.totalHits;\n        const galleryParentElemMarkup = '<div class=\"gallery\"></div>';\n        refs.galleryEl.insertAdjacentHTML(\"afterbegin\", galleryParentElemMarkup);\n\n        if (query) {\n            if (data.hits.length > 0) {\n            loader.remove();\n            renderImages(data.hits);\n            checkBtnStatus();\n            simpleLightBox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 }).refresh();\n            } else {\n                loader.remove();\n                iziToast.show({\n                    timeout: 5000,\n                    position: 'topCenter',\n                    color: '#d11804',\n                    messageColor: 'white',\n                    titleColor: '#FFFFFF',\n                    iconColor: '#FFFFFF',\n                    message: \"Sorry, there are no images matching your search query. Please try again!\",\n                });\n                refs.btnLoadMore.classList.add('hidden');\n            };\n        } else {\n            loader.remove();\n            iziToast.show({\n                timeout: 5000,\n                position: 'topCenter',\n                color: '#d11804',\n                messageColor: 'white',\n                titleColor: '#FFFFFF',\n                iconColor: '#FFFFFF',\n                message: \"The field is empty. Please enter a word!\",\n            });\n            refs.btnLoadMore.classList.add('hidden');\n        };\n    } catch (err) {\n        iziToast.show({\n            timeout: 5000,\n            position: 'topCenter',\n            color: '#d11804',\n            messageColor: 'white',\n            titleColor: '#FFFFFF',\n            iconColor: '#FFFFFF',\n            message: err.message,\n        });\n        refs.btnLoadMore.classList.add('hidden');\n    };\n    \n    refs.formEl.reset();\n    refs.btnEl.disabled = true;\n    refs.btnEl.classList.add('disabled');\n};\n\n\nasync function getImage() {\n    const BASE_URL = 'https://pixabay.com';\n    const END_POINT = '/api/';\n    const PARAMS = `?key=42153044-59e7d8487fc2c2f8c6f74878d&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${PAGE_SIZE}`;\n    const url = `${BASE_URL}${END_POINT}${PARAMS}`;\n    const res = await axios.get(url);\n    return res.data;\n};\n\nfunction checkBtnStatus() { \n    const maxPage = Math.ceil(totalHits / PAGE_SIZE);\n    const isLastPage = maxPage <= currentPage;\n    if (isLastPage) {\n        refs.btnLoadMore.classList.add('hidden');\n        iziToast.show({\n                    timeout: 5000,\n                    position: 'topCenter',\n                    color: '#d11804',\n                    messageColor: 'white',\n                    titleColor: '#FFFFFF',\n                    iconColor: '#FFFFFF',\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                });\n    } else {\n        refs.btnLoadMore.classList.remove('hidden');\n    };\n};\n"],"names":["simpleLightBox","onFormSubmit","onLoadMoreClick","e","loader","data","getImage","SimpleLightbox","checkBtnStatus","galleryParentElem","galleryParentElemMarkup","iziToast","err","BASE_URL","END_POINT","PARAMS","url","axios"],"mappings":"+vBAMA,IAAIA,EAGW,SAAS,cAAc,aAAa,EAEnD,KAAK,OAAO,iBAAiB,SAAUC,CAAY,EACnD,KAAK,YAAY,iBAAiB,QAASC,CAAe,EAC1D,KAAK,OAAO,iBAAiB,QAASC,GAAK,CACpB,KAAK,OAAO,SAAS,KAAK,MAAM,SAE/C,KAAK,MAAM,SAAW,GACtB,KAAK,MAAM,UAAU,OAAO,UAAU,EAE9C,CAAC,EAID,eAAeD,GAAkB,CAC7B,KAAK,UAAU,mBAAmB,WAAY,6DAA6D,EAC3G,MAAME,EAAS,SAAS,cAAc,aAAa,EACnD,aAAe,EACf,MAAMC,EAAO,MAAMC,IACnB,aAAaD,EAAK,IAAI,EACtBD,EAAO,OAAM,EACbJ,EAAiB,IAAIO,EAAe,aAAc,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,EAAE,UAC9FC,GACJ,CAGA,eAAeP,EAAaE,EAAG,CAC3BA,EAAE,eAAc,EAChB,KAAK,OAAO,mBAAmB,WAAY,6DAA6D,EACxG,MAAMM,EAAoB,SAAS,cAAc,UAAU,EACvDA,GACAA,EAAkB,OAAM,EAE5B,MAAML,EAAS,SAAS,cAAc,aAAa,EACnD,MAAQD,EAAE,OAAO,SAAS,KAAK,MAAM,OACrC,YAAc,EACd,GAAI,CACA,MAAME,EAAO,MAAMC,IACnB,UAAYD,EAAK,UACjB,MAAMK,EAA0B,8BAChC,KAAK,UAAU,mBAAmB,aAAcA,CAAuB,EAEnE,MACIL,EAAK,KAAK,OAAS,GACvBD,EAAO,OAAM,EACb,aAAaC,EAAK,IAAI,EACtBG,IACAR,EAAiB,IAAIO,EAAe,aAAc,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,EAAE,YAE1FH,EAAO,OAAM,EACbO,EAAS,KAAK,CACV,QAAS,IACT,SAAU,YACV,MAAO,UACP,aAAc,QACd,WAAY,UACZ,UAAW,UACX,QAAS,0EAC7B,CAAiB,EACD,KAAK,YAAY,UAAU,IAAI,QAAQ,IAG3CP,EAAO,OAAM,EACbO,EAAS,KAAK,CACV,QAAS,IACT,SAAU,YACV,MAAO,UACP,aAAc,QACd,WAAY,UACZ,UAAW,UACX,QAAS,0CACzB,CAAa,EACD,KAAK,YAAY,UAAU,IAAI,QAAQ,EAE9C,OAAQC,EAAK,CACVD,EAAS,KAAK,CACV,QAAS,IACT,SAAU,YACV,MAAO,UACP,aAAc,QACd,WAAY,UACZ,UAAW,UACX,QAASC,EAAI,OACzB,CAAS,EACD,KAAK,YAAY,UAAU,IAAI,QAAQ,CAE/C,CACI,KAAK,OAAO,QACZ,KAAK,MAAM,SAAW,GACtB,KAAK,MAAM,UAAU,IAAI,UAAU,CACvC,CAGA,eAAeN,GAAW,CACtB,MAAMO,EAAW,sBACXC,EAAY,QACZC,EAAS,6CAA6C,KAAK,iEAAiE,WAAW,aAAa,SAAS,GAC7JC,EAAM,GAAGH,CAAQ,GAAGC,CAAS,GAAGC,CAAM,GAE5C,OADY,MAAME,EAAM,IAAID,CAAG,GACpB,IACf,CAEA,SAASR,GAAiB,CACN,KAAK,KAAK,UAAY,SAAS,GACjB,aAE1B,KAAK,YAAY,UAAU,IAAI,QAAQ,EACvCG,EAAS,KAAK,CACF,QAAS,IACT,SAAU,YACV,MAAO,UACP,aAAc,QACd,WAAY,UACZ,UAAW,UACX,QAAS,4DAC7B,CAAiB,GAET,KAAK,YAAY,UAAU,OAAO,QAAQ,CAElD"}