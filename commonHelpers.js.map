{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nlet query = '';\nlet currentPage = 1;\nlet totalHits = 0;\nconst PAGE_SIZE = 15;\n\n\nlet simpleLightBox;\n\nasync function getImage() {\n    const BASE_URL = 'https://pixabay.com';\n    const END_POINT = '/api/';\n    const PARAMS = `?key=42153044-59e7d8487fc2c2f8c6f74878d&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${PAGE_SIZE}`;\n    const url = `${BASE_URL}${END_POINT}${PARAMS}`;\n    const res = await axios.get(url);\n    return res.data;\n};\n\n\nexport const refs = {\n    formEl: document.querySelector('.search-form'),\n    galleryEl: document.querySelector('.gallery-box'),\n    btnEl: document.querySelector('.search-btn'),\n    btnLoadMore: document.querySelector('.load-btn'),\n};\n\nconst loader = document.querySelector('.loader-box');\n\nrefs.formEl.addEventListener('submit', onFormSubmit);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\nrefs.formEl.addEventListener('input', e => {\n    const searchWord = refs.formEl.elements.word.value.trim();\n    if (searchWord) {\n        refs.btnEl.disabled = false;\n        refs.btnEl.classList.remove('disabled');\n    };\n});\n\nasync function onLoadMoreClick() {\n    currentPage += 1;\n    const data = await getImage();\n    renderImages(data.hits);\n    simpleLightBox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 }).refresh();\n    checkBtnStatus();\n};\n\n\n\n\nasync function onFormSubmit(e) {\n    e.preventDefault();\n    refs.formEl.insertAdjacentHTML(\"afterend\", '<div class=\"loader-box \"><span class=\"loader\"></span></div>');\n    const galleryParentElem = document.querySelector('.gallery');\n    if (galleryParentElem) {\n        galleryParentElem.remove();\n    };\n    const loader = document.querySelector('.loader-box');\n    query = e.target.elements.word.value.trim();\n    currentPage = 1;\n    try {\n        const data = await getImage();\n        totalHits = data.totalHits;\n        const galleryParentElemMarkup = '<div class=\"gallery\"></div>';\n        refs.galleryEl.insertAdjacentHTML(\"afterbegin\", galleryParentElemMarkup);\n\n        if (query) {\n            if (data.hits.length > 0) {\n            loader.remove();\n            renderImages(data.hits);\n            simpleLightBox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 }).refresh();\n            } else {\n                loader.remove();\n                iziToast.show({\n                    timeout: 5000,\n                    position: 'topCenter',\n                    color: '#d11804',\n                    messageColor: 'white',\n                    titleColor: '#FFFFFF',\n                    iconColor: '#FFFFFF',\n                    message: \"Sorry, there are no images matching your search query. Please try again!\",\n                });\n            };\n        } else {\n            loader.remove();\n            iziToast.show({\n                timeout: 5000,\n                position: 'topCenter',\n                color: '#d11804',\n                messageColor: 'white',\n                titleColor: '#FFFFFF',\n                iconColor: '#FFFFFF',\n                message: \"The field is empty. Please enter a word!\",\n            });\n            refs.btnLoadMore.classList.add('hidden');\n        };\n    } catch (err) {\n        iziToast.show({\n            timeout: 5000,\n            position: 'topCenter',\n            color: '#d11804',\n            messageColor: 'white',\n            titleColor: '#FFFFFF',\n            iconColor: '#FFFFFF',\n            message: err.message,\n            });\n    };\n    checkBtnStatus();\n    refs.formEl.reset();\n    refs.btnEl.disabled = true;\n    refs.btnEl.classList.add('disabled');\n};\n\n\n\nfunction imageTemplate({ id, largeImageURL, webformatURL, tags, likes, views, comments, downloads }) {\n    return `<a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <div class=\"gallery-item\" id=\"${id}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" data-source=\"${largeImageURL}\"/>\n            <div class=\"info\">\n              <p class=\"info-item\"><b>Likes</b>${likes}</p>\n              <p class=\"info-item\"><b>Views</b>${views}</p>\n              <p class=\"info-item\"><b>Comments</b>${comments}</p>\n              <p class=\"info-item\"><b>Downloads</b>${downloads}</p>\n            </div>\n          </div>\n        </a>`;\n};\n\nfunction renderImages(arr) {\n    const markup = arr.map(imageTemplate).join('');\n    const gallery = refs.galleryEl.querySelector('.gallery');\n    gallery.insertAdjacentHTML('beforeend', markup);\n};\n\nfunction checkBtnStatus() { \n    const maxPage = Math.ceil(totalHits / PAGE_SIZE);\n    const isLastPage = maxPage <= currentPage;\n    if (isLastPage) {\n        refs.btnLoadMore.classList.add('hidden');\n    } else {\n        refs.btnLoadMore.classList.remove('hidden');\n    };\n};\n\n\n// async function onFormSubmit(e) {\n//     e.preventDefault();\n//     refs.formEl.insertAdjacentHTML(\"afterend\", '<div class=\"loader-box \"><span class=\"loader\"></span></div>');\n\n//     const loader = document.querySelector('.loader-box');\n\n//     const galleryParentElem = document.querySelector('.gallery');\n//     if (galleryParentElem) { galleryParentElem.remove(); };\n    \n//     const galleryParentElemMarkup = '<div class=\"gallery\"></div>';\n//     refs.galleryEl.insertAdjacentHTML(\"afterbegin\", galleryParentElemMarkup);\n\n//     const searchWord = e.target.elements.word.value.trim();\n\n    // if (searchWord) { \n    //     const data = await searchImage();\n    //     let imagesArray = data.hits;\n    //     if (imagesArray.length > 0) {\n    //         loader.remove();\n    //         const markup = renderImages(imagesArray);\n    //         addMarkup(markup);\n    //                 // const gallery = refs.galleryEl.querySelector('.gallery');\n    //                 // gallery.insertAdjacentHTML('beforeend', markup);\n    //         simpleLightBox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 }).refresh();\n    //     } else {\n    //         loader.remove();\n    //         iziToast.show({\n    //             timeout: 5000,\n    //             position: 'topCenter',\n    //             color: '#d11804',\n    //             messageColor: 'white',\n    //             titleColor: '#FFFFFF',\n    //             iconColor: '#FFFFFF',\n    //             message: \"Sorry, there are no images matching your search query. Please try again!\",\n    //         });\n    //     };\n    // } else {\n    //     loader.remove();\n    //     iziToast.show({\n    //         timeout: 5000,\n    //         position: 'topCenter',\n    //         color: '#d11804',\n    //         messageColor: 'white',\n    //         titleColor: '#FFFFFF',\n    //         iconColor: '#FFFFFF',\n    //         message: \"The field is empty. Please enter a word!\",\n    //     });\n    // };\n\n//     refs.formEl.reset();\n//     refs.btnEl.disabled = true;\n//     refs.btnEl.classList.add('disabled');\n\n// };\n\n\n// async function searchImage() {\n//     const URL = 'https://pixabay.com';\n//     const END_POINT = '/api/';\n//     const PARAMS = `?key=42153044-59e7d8487fc2c2f8c6f74878d&q=${searchWord}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${PAGE_SIZE}`;\n    \n\n//     const url = URL + END_POINT + PARAMS; \n\n//     const res = await axios.get(url);\n\n//     return res.data;\n\n// };\n\n\n//     const url = URL + END_POINT + PARAMS; \n\n//     const res = await axios.get(url);\n\n//     return res.data;\n\n\n// export class ImagesApi {\n//     constructor() {\n//         this.BASE_URL = 'https://pixabay.com';\n//         this.END_POINT = '/api/';\n//     }\n    \n//     getImages(query) {\n//         const PARAMS = {\n//             key = '42153044-59e7d8487fc2c2f8c6f74878d',\n//             q = query,\n//             image_type = 'photo',\n//             orientation = 'horizontal',\n//             safesearch = true,\n//             page = currentPage,\n//             per_page = PAGE_SIZE\n\n//         };\n//         const url = `${this.BASE_URL}${this.END_POINT}`;\n\n//         return axios.get(url, PARAMS);\n//     }\n// }\n\n\n// let searchWord = '';\n// let currentPage = 1;\n// let totalHits = 0;\n// const PAGE_SIZE = 15;"],"names":["query","currentPage","totalHits","PAGE_SIZE","simpleLightBox","getImage","BASE_URL","END_POINT","PARAMS","url","axios","refs","onFormSubmit","onLoadMoreClick","e","data","renderImages","SimpleLightbox","checkBtnStatus","galleryParentElem","loader","galleryParentElemMarkup","iziToast","err","imageTemplate","id","largeImageURL","webformatURL","tags","likes","views","comments","downloads","arr","markup"],"mappings":"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"}