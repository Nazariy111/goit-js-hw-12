{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js"],"sourcesContent":["const refs = {\n    formEl: document.querySelector('.search-form'),\n    galleryEl: document.querySelector('.gallery-box'),\n    btnEl: document.querySelector('.search-btn'),\n    btnLoadMore: document.querySelector('.load-btn'),\n    \n};\n\nexport function imageTemplate({ id, largeImageURL, webformatURL, tags, likes, views, comments, downloads }) {\n    return `<a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <div class=\"gallery-item\" id=\"${id}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" data-source=\"${largeImageURL}\"/>\n            <div class=\"info\">\n              <p class=\"info-item\"><b>Likes</b>${likes}</p>\n              <p class=\"info-item\"><b>Views</b>${views}</p>\n              <p class=\"info-item\"><b>Comments</b>${comments}</p>\n              <p class=\"info-item\"><b>Downloads</b>${downloads}</p>\n            </div>\n          </div>\n        </a>`;\n};\n\nexport function renderImages(arr) {\n    const markup = arr.map(imageTemplate).join('');\n    const gallery = refs.galleryEl.querySelector('.gallery');\n    gallery.insertAdjacentHTML('beforeend', markup);\n};","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\nimport { imageTemplate } from \"./render-functions\";\nimport { renderImages } from \"./render-functions\";\n\nconst PAGE_SIZE = 15;\nlet query = '';\nlet currentPage = 1;\nlet totalHits = 0;\n\nconst refs = {\n    formEl: document.querySelector('.search-form'),\n    galleryEl: document.querySelector('.gallery-box'),\n    btnEl: document.querySelector('.search-btn'),\n    btnLoadMore: document.querySelector('.load-btn'),\n    \n};\n\nlet simpleLightBox;\n\n\nconst loader = document.querySelector('.loader-box');\n\nrefs.formEl.addEventListener('submit', onFormSubmit);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\nrefs.formEl.addEventListener('input', e => {\n    const searchWord = refs.formEl.elements.word.value.trim();\n    if (searchWord) {\n        refs.btnEl.disabled = false;\n        refs.btnEl.classList.remove('disabled');\n    };\n});\n\n\n\nasync function onLoadMoreClick() {\n    refs.galleryEl.insertAdjacentHTML(\"afterend\", '<div class=\"loader-box \"><span class=\"loader\"></span></div>');\n    const loader = document.querySelector('.loader-box');\n    currentPage += 1;\n    const oneGalleryElem = document.querySelector('.gallery-link');\n    const elem = oneGalleryElem.getBoundingClientRect();\n    console.log(elem.height);\n\n    const data = await getImage();\n    renderImages(data.hits);\n    loader.remove();\n    window.scrollBy(0, (elem.height * 2));\n    simpleLightBox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 }).refresh();\n    checkBtnStatus();\n};\n\n\nasync function onFormSubmit(e) {\n    e.preventDefault();\n    refs.formEl.insertAdjacentHTML(\"afterend\", '<div class=\"loader-box \"><span class=\"loader\"></span></div>');\n    const galleryParentElem = document.querySelector('.gallery');\n    if (galleryParentElem) {\n        galleryParentElem.remove();\n    };\n    const loader = document.querySelector('.loader-box');\n    query = e.target.elements.word.value.trim();\n    currentPage = 1;\n    try {\n        const data = await getImage();\n        totalHits = data.totalHits;\n        const galleryParentElemMarkup = '<div class=\"gallery\"></div>';\n        refs.galleryEl.insertAdjacentHTML(\"afterbegin\", galleryParentElemMarkup);\n\n        if (query) {\n            if (data.hits.length > 0) {\n            loader.remove();\n            renderImages(data.hits);\n            checkBtnStatus();\n            simpleLightBox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 }).refresh();\n            } else {\n                loader.remove();\n                iziToast.show({\n                    timeout: 5000,\n                    position: 'topCenter',\n                    color: '#d11804',\n                    messageColor: 'white',\n                    titleColor: '#FFFFFF',\n                    iconColor: '#FFFFFF',\n                    message: \"Sorry, there are no images matching your search query. Please try again!\",\n                });\n                refs.btnLoadMore.classList.add('hidden');\n            };\n        } else {\n            loader.remove();\n            iziToast.show({\n                timeout: 5000,\n                position: 'topCenter',\n                color: '#d11804',\n                messageColor: 'white',\n                titleColor: '#FFFFFF',\n                iconColor: '#FFFFFF',\n                message: \"The field is empty. Please enter a word!\",\n            });\n            refs.btnLoadMore.classList.add('hidden');\n        };\n    } catch (err) {\n        iziToast.show({\n            timeout: 5000,\n            position: 'topCenter',\n            color: '#d11804',\n            messageColor: 'white',\n            titleColor: '#FFFFFF',\n            iconColor: '#FFFFFF',\n            message: err.message,\n        });\n        refs.btnLoadMore.classList.add('hidden');\n    };\n    \n    refs.formEl.reset();\n    refs.btnEl.disabled = true;\n    refs.btnEl.classList.add('disabled');\n};\n\n\nasync function getImage() {\n    const BASE_URL = 'https://pixabay.com';\n    const END_POINT = '/api/';\n    const PARAMS = `?key=42153044-59e7d8487fc2c2f8c6f74878d&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${PAGE_SIZE}`;\n    const url = `${BASE_URL}${END_POINT}${PARAMS}`;\n    const res = await axios.get(url);\n    return res.data;\n};\n\nfunction checkBtnStatus() { \n    const maxPage = Math.ceil(totalHits / PAGE_SIZE);\n    const isLastPage = maxPage <= currentPage;\n    if (isLastPage) {\n        refs.btnLoadMore.classList.add('hidden');\n        iziToast.show({\n                    timeout: 5000,\n                    position: 'topCenter',\n                    color: '#d11804',\n                    messageColor: 'white',\n                    titleColor: '#FFFFFF',\n                    iconColor: '#FFFFFF',\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                });\n    } else {\n        refs.btnLoadMore.classList.remove('hidden');\n    };\n};\n"],"names":["refs","imageTemplate","id","largeImageURL","webformatURL","tags","likes","views","comments","downloads","renderImages","arr","markup","PAGE_SIZE","query","currentPage","totalHits","simpleLightBox","onFormSubmit","onLoadMoreClick","e","loader","elem","data","getImage","SimpleLightbox","checkBtnStatus","galleryParentElem","galleryParentElemMarkup","iziToast","err","BASE_URL","END_POINT","PARAMS","url","axios"],"mappings":"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"}